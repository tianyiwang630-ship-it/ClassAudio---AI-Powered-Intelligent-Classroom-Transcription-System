# 快速启动指南

## 问题已解决

**问题**: 前端显示"连接断开"
**原因**: Windows 控制台编码问题导致后端启动失败
**状态**: ✅ 已修复

---

## 启动方法

### 方法 1: 使用批处理文件（最简单）

双击运行:
```
启动ClassAudio.bat
```

### 方法 2: 命令行启动

```bash
# 1. 打开命令提示符 (cmd)
# 2. 进入项目目录
cd d:\files\demo\classaudio

# 3. 激活 aiagent 环境并启动
D:\Anaconda\envs\aiagent\python.exe run.py
```

### 方法 3: 使用 Anaconda Prompt

```bash
# 1. 打开 Anaconda Prompt
# 2. 激活环境
conda activate aiagent

# 3. 进入项目目录
cd d:\files\demo\classaudio

# 4. 启动
python run.py
```

---

## 启动成功的标志

### 1. 后端控制台输出

应该看到类似以下内容:

```
============================================================
ClassAudio Backend Starting...
============================================================

[1/2] Initializing Audio Service...
      Loading Whisper models (this may take a few minutes)...
      Loading VAD model...
      Loading Whisper Partial model...
      Loading Whisper Final model...
      All models loaded successfully!
      ✓ Audio Service initialized successfully!

[2/2] Initializing LLM Service...
      ✓ LLM Service initialized successfully!

      ✓ Services connected!

============================================================
All services initialized successfully!
============================================================

INFO:     Uvicorn running on http://0.0.0.0:8000
```

### 2. 前端页面

浏览器会自动打开 `http://localhost:8080/index.html`

应该看到:
- 状态显示: **"就绪"** (绿色圆点)
- 通知: "服务就绪 - 后端服务连接正常"
- "开始录音" 按钮可点击

---

## 如果仍然出现问题

### 检查端口占用

```bash
# 检查 8000 端口
netstat -ano | findstr :8000

# 如果被占用，终止进程
taskkill /F /PID <进程ID>
```

### 查看详细日志

```bash
# 直接启动后端（查看详细日志）
cd d:\files\demo\classaudio
D:\Anaconda\envs\aiagent\python.exe -m uvicorn src.api.server:app --host 0.0.0.0 --port 8000 --log-level debug
```

### 运行诊断工具

```bash
cd d:\files\demo\classaudio
D:\Anaconda\envs\aiagent\python.exe test_backend.py
```

---

## 重要说明

1. **必须使用 aiagent 环境**
   - 该环境包含所有必需的依赖包
   - Python 3.10 + PyTorch 2.8.0 + CUDA

2. **首次启动较慢**
   - 需要加载 Whisper 模型（约 1-2 分钟）
   - 模型加载后，后续启动会快很多

3. **CUDA 加速**
   - 你的环境支持 CUDA（GPU 加速）
   - 转写速度会非常快

---

## 使用流程

1. **启动**: 运行 `启动ClassAudio.bat`
2. **等待**: 等待后端加载模型（1-2 分钟）
3. **打开**: 浏览器自动打开前端页面
4. **录音**: 点击"开始录音"按钮
5. **说话**: 对着麦克风说话
6. **查看**: 实时查看字幕和 LLM 整理的笔记
7. **停止**: 点击"停止录音"
8. **导出**: 点击"导出笔记"保存为 Markdown

---

**更新时间**: 2026-01-17
**状态**: ✅ 正常工作
